<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data transformation | NYC School Survey</title>
  <meta name="description" content="Chapter 3 Data transformation | NYC School Survey" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data transformation | NYC School Survey" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data transformation | NYC School Survey" />
  
  
  

<meta name="author" content="Ziheng Ru, Zihan Wang" />


<meta name="date" content="2021-11-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-sources.html"/>
<link rel="next" href="missing-values.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">NYCSchoolSurvey</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction-to-nyc-school-survey"><i class="fa fa-check"></i><b>1.1</b> Introduction to NYC School Survey</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#our-goal-in-this-project"><i class="fa fa-check"></i><b>1.2</b> Our goal in this project</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#data-source-links"><i class="fa fa-check"></i><b>2.1</b> Data source links</a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#a-glimpse-at-our-dataset"><i class="fa fa-check"></i><b>2.2</b> A glimpse at our dataset</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-sources.html"><a href="data-sources.html#student-reponse-dataset"><i class="fa fa-check"></i><b>2.2.1</b> Student Reponse dataset</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-sources.html"><a href="data-sources.html#teacher-reponse-dataset"><i class="fa fa-check"></i><b>2.2.2</b> Teacher Reponse dataset</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-sources.html"><a href="data-sources.html#parent-reponse-dataset"><i class="fa fa-check"></i><b>2.2.3</b> Parent Reponse dataset</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-sources.html"><a href="data-sources.html#meanings-of-columns"><i class="fa fa-check"></i><b>2.3</b> Meanings of columns</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-transformation.html"><a href="data-transformation.html#step1-change-column-names"><i class="fa fa-check"></i><b>3.1</b> Step1: Change column names</a></li>
<li class="chapter" data-level="3.2" data-path="data-transformation.html"><a href="data-transformation.html#step2-merge-three-dataframes"><i class="fa fa-check"></i><b>3.2</b> Step2: Merge Three DataFrames</a></li>
<li class="chapter" data-level="3.3" data-path="data-transformation.html"><a href="data-transformation.html#step3-change-data-types"><i class="fa fa-check"></i><b>3.3</b> Step3: Change Data Types</a></li>
<li class="chapter" data-level="3.4" data-path="data-transformation.html"><a href="data-transformation.html#step4-tidying-data-with-pivot_longer"><i class="fa fa-check"></i><b>3.4</b> Step4: Tidying data with pivot_longer</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NYC School Survey</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-transformation" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Data transformation</h1>
<div id="step1-change-column-names" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Step1: Change column names</h2>
<p>The column names in the original dataset are too long and contain white spaces, which is inconvenient for future development. Moreover, all the column names are the same for student, teacher and parent dataset, thus we cannot discriminate among them after merging these three dataframes in Step2.</p>
<p>Therefore, for the first step, we change each long column name to a shorter yet clear name, with prefix “s_”,“t_”, and “p_” for student, teacher and parent respectively.</p>
<p>The column names of students response result after transformation is:</p>
<pre><code>##  [1] &quot;DBN&quot;                    &quot;name&quot;                   &quot;parent_rr&quot;             
##  [4] &quot;teacher_rr&quot;             &quot;student_rr&quot;             &quot;s_collab_teachers&quot;     
##  [7] &quot;s_effective_schlead&quot;    &quot;s_rig_instruction&quot;      &quot;s_supp_env&quot;            
## [10] &quot;s_family_communityties&quot; &quot;s_trust&quot;</code></pre>
<p>The column names of teacher response result after transformation is:</p>
<pre><code>##  [1] &quot;DBN&quot;                    &quot;name&quot;                   &quot;parent_rr&quot;             
##  [4] &quot;teacher_rr&quot;             &quot;student_rr&quot;             &quot;t_collab_teachers&quot;     
##  [7] &quot;t_effective_schlead&quot;    &quot;t_rig_instruction&quot;      &quot;t_supp_env&quot;            
## [10] &quot;t_family_communityties&quot; &quot;t_trust&quot;</code></pre>
<p>The column names of parent response result after transformation is:</p>
<pre><code>##  [1] &quot;DBN&quot;                    &quot;name&quot;                   &quot;parent_rr&quot;             
##  [4] &quot;teacher_rr&quot;             &quot;student_rr&quot;             &quot;p_collab_teachers&quot;     
##  [7] &quot;p_effective_schlead&quot;    &quot;p_rig_instruction&quot;      &quot;p_supp_env&quot;            
## [10] &quot;p_family_communityties&quot; &quot;p_trust&quot;</code></pre>
</div>
<div id="step2-merge-three-dataframes" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Step2: Merge Three DataFrames</h2>
<p>From the result in Chapter 2 we know that parent, student and teacher response datasets do not have the same row numbers, suggesting that some schools in one dataset may not exist in other datasets.</p>
<pre><code>## dim of student is: 1831 11</code></pre>
<pre><code>## dim of parent is: 2946 11</code></pre>
<pre><code>## dim of teacher is: 1903 11</code></pre>
<p>In order to be consistent, we firstly merge the three datasets and only keep those schools who exist in all of these three datasets. Moreover, the parent/teacher/student response rate should be the same in those three datasets, therefore we merge the three datasets by [“DBN”,“name”,“parent_rr”,“student_rr”,“teacher_rr”]. A summary of the merged dataset is shown as below:</p>
<pre><code>## &#39;data.frame&#39;:    1829 obs. of  23 variables:
##  $ DBN                   : chr  &quot;01M015&quot; &quot;01M019&quot; &quot;01M020&quot; &quot;01M034&quot; ...
##  $ name                  : chr  &quot;P.S. 015 ROBERTO CLEMENTE&quot; &quot;P.S. 019 ASHER LEVY&quot; &quot;P.S. 020 ANNA SILVER&quot; &quot;P.S. 034 FRANKLIN D. ROOSEVELT&quot; ...
##  $ parent_rr             : num  91 100 58 29 80 52 79 46 57 100 ...
##  $ teacher_rr            : num  100 93 90 100 100 96 77 93 89 100 ...
##  $ student_rr            : chr  &quot;N/A&quot; &quot;N/A&quot; &quot;N/A&quot; &quot;95&quot; ...
##  $ s_collab_teachers     : chr  &quot;4.0999999999999996&quot; &quot;4.53&quot; &quot;2.71&quot; &quot;2.69&quot; ...
##  $ s_effective_schlead   : chr  &quot;4.1900000000000004&quot; &quot;4.51&quot; &quot;2.98&quot; &quot;2.59&quot; ...
##  $ s_rig_instruction     : chr  &quot;4.0199999999999996&quot; &quot;4.8&quot; &quot;1.92&quot; &quot;2.14&quot; ...
##  $ s_supp_env            : chr  &quot;N/A&quot; &quot;N/A&quot; &quot;N/A&quot; &quot;N/A&quot; ...
##  $ s_family_communityties: chr  &quot;4.18&quot; &quot;4.66&quot; &quot;3.84&quot; &quot;3.67&quot; ...
##  $ s_trust               : chr  &quot;3.96&quot; &quot;3.76&quot; &quot;3.14&quot; &quot;2.38&quot; ...
##  $ t_collab_teachers     : chr  &quot;4.0999999999999996&quot; &quot;4.53&quot; &quot;2.71&quot; &quot;2.69&quot; ...
##  $ t_effective_schlead   : chr  &quot;4.1900000000000004&quot; &quot;4.51&quot; &quot;2.98&quot; &quot;2.59&quot; ...
##  $ t_rig_instruction     : chr  &quot;4.0199999999999996&quot; &quot;4.8&quot; &quot;1.92&quot; &quot;2.14&quot; ...
##  $ t_supp_env            : chr  &quot;N/A&quot; &quot;N/A&quot; &quot;N/A&quot; &quot;N/A&quot; ...
##  $ t_family_communityties: chr  &quot;4.18&quot; &quot;4.66&quot; &quot;3.84&quot; &quot;3.67&quot; ...
##  $ t_trust               : chr  &quot;3.96&quot; &quot;3.76&quot; &quot;3.14&quot; &quot;2.38&quot; ...
##  $ p_collab_teachers     : chr  &quot;4.0999999999999996&quot; &quot;4.53&quot; &quot;2.71&quot; &quot;2.69&quot; ...
##  $ p_effective_schlead   : chr  &quot;4.1900000000000004&quot; &quot;4.51&quot; &quot;2.98&quot; &quot;2.59&quot; ...
##  $ p_rig_instruction     : chr  &quot;4.0199999999999996&quot; &quot;4.8&quot; &quot;1.92&quot; &quot;2.14&quot; ...
##  $ p_supp_env            : chr  &quot;N/A&quot; &quot;N/A&quot; &quot;N/A&quot; &quot;N/A&quot; ...
##  $ p_family_communityties: chr  &quot;4.18&quot; &quot;4.66&quot; &quot;3.84&quot; &quot;3.67&quot; ...
##  $ p_trust               : chr  &quot;3.96&quot; &quot;3.76&quot; &quot;3.14&quot; &quot;2.38&quot; ...</code></pre>
</div>
<div id="step3-change-data-types" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Step3: Change Data Types</h2>
<p>After step2, we have a integrated dataset that combines data from student, teacher and parent datasets. However, the data types of many columns are incorrect – instead of character, they should be float. Therefore, we convert the data type of those columns to <code>numeric</code>.</p>
<p>The summary of data after transformation is shown as below:</p>
<pre><code>## &#39;data.frame&#39;:    1829 obs. of  23 variables:
##  $ DBN                   : chr  &quot;01M015&quot; &quot;01M019&quot; &quot;01M020&quot; &quot;01M034&quot; ...
##  $ name                  : chr  &quot;P.S. 015 ROBERTO CLEMENTE&quot; &quot;P.S. 019 ASHER LEVY&quot; &quot;P.S. 020 ANNA SILVER&quot; &quot;P.S. 034 FRANKLIN D. ROOSEVELT&quot; ...
##  $ parent_rr             : num  91 100 58 29 80 52 79 46 57 100 ...
##  $ teacher_rr            : num  100 93 90 100 100 96 77 93 89 100 ...
##  $ student_rr            : num  NA NA NA 95 NA NA NA NA 87 NA ...
##  $ s_collab_teachers     : num  4.1 4.53 2.71 2.69 NA 4.56 3.11 2.51 3.44 3.55 ...
##  $ s_effective_schlead   : num  4.19 4.51 2.98 2.59 NA 4.09 3.15 1.53 4.21 3.73 ...
##  $ s_rig_instruction     : num  4.02 4.8 1.92 2.14 NA 3.74 1.96 3.19 3.4 3.23 ...
##  $ s_supp_env            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ s_family_communityties: num  4.18 4.66 3.84 3.67 NA 4.18 3.67 3.38 3.59 4.01 ...
##  $ s_trust               : num  3.96 3.76 3.14 2.38 3.77 4.04 3.29 2.55 3.7 3.12 ...
##  $ t_collab_teachers     : num  4.1 4.53 2.71 2.69 NA 4.56 3.11 2.51 3.44 3.55 ...
##  $ t_effective_schlead   : num  4.19 4.51 2.98 2.59 NA 4.09 3.15 1.53 4.21 3.73 ...
##  $ t_rig_instruction     : num  4.02 4.8 1.92 2.14 NA 3.74 1.96 3.19 3.4 3.23 ...
##  $ t_supp_env            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ t_family_communityties: num  4.18 4.66 3.84 3.67 NA 4.18 3.67 3.38 3.59 4.01 ...
##  $ t_trust               : num  3.96 3.76 3.14 2.38 3.77 4.04 3.29 2.55 3.7 3.12 ...
##  $ p_collab_teachers     : num  4.1 4.53 2.71 2.69 NA 4.56 3.11 2.51 3.44 3.55 ...
##  $ p_effective_schlead   : num  4.19 4.51 2.98 2.59 NA 4.09 3.15 1.53 4.21 3.73 ...
##  $ p_rig_instruction     : num  4.02 4.8 1.92 2.14 NA 3.74 1.96 3.19 3.4 3.23 ...
##  $ p_supp_env            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ p_family_communityties: num  4.18 4.66 3.84 3.67 NA 4.18 3.67 3.38 3.59 4.01 ...
##  $ p_trust               : num  3.96 3.76 3.14 2.38 3.77 4.04 3.29 2.55 3.7 3.12 ...</code></pre>
</div>
<div id="step4-tidying-data-with-pivot_longer" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Step4: Tidying data with pivot_longer</h2>
<p>Now we have an integrated dataset with correct data types. However, the dataset is still “messy”. In order to perform the future data visualization more conveniently, we need to change the “messy data” to “tidy data” with <code>pivot_longer</code>.</p>
<p>A summary of the tidy data is shown as below, with variable <code>aspect</code> denotes the certain aspect of the school education evaluated by students, parents and teachers. The variable <code>score</code> denotes the score of a certain aspect.</p>
<pre><code>## tibble [32,922 x 7] (S3: tbl_df/tbl/data.frame)
##  $ DBN       : chr [1:32922] &quot;01M015&quot; &quot;01M015&quot; &quot;01M015&quot; &quot;01M015&quot; ...
##  $ name      : chr [1:32922] &quot;P.S. 015 ROBERTO CLEMENTE&quot; &quot;P.S. 015 ROBERTO CLEMENTE&quot; &quot;P.S. 015 ROBERTO CLEMENTE&quot; &quot;P.S. 015 ROBERTO CLEMENTE&quot; ...
##  $ parent_rr : num [1:32922] 91 91 91 91 91 91 91 91 91 91 ...
##  $ teacher_rr: num [1:32922] 100 100 100 100 100 100 100 100 100 100 ...
##  $ student_rr: num [1:32922] NA NA NA NA NA NA NA NA NA NA ...
##  $ aspect    : chr [1:32922] &quot;s_collab_teachers&quot; &quot;s_effective_schlead&quot; &quot;s_rig_instruction&quot; &quot;s_supp_env&quot; ...
##  $ score     : num [1:32922] 4.1 4.19 4.02 NA 4.18 3.96 4.1 4.19 4.02 NA ...</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-sources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="missing-values.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hannawong/NYCSchoolSurvey/edit/main/03-cleaning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/hannawong/NYCSchoolSurvey/blob/main/03-cleaning.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
